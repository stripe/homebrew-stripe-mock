# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class StripeMock < Formula
  desc "stripe-mock is a mock HTTP server that responds like the real Stripe API. It can be used instead of Stripe's testmode to make test suites integrating with Stripe faster and less brittle."
  homepage "https://github.com/stripe/stripe-mock"
  version "0.152.0"

  on_macos do
    if Hardware::CPU.arm?
      url "https://github.com/stripe/stripe-mock/releases/download/v0.152.0/stripe-mock_0.152.0_darwin_arm64.tar.gz"
      sha256 "82d8065cffc450b71b6b6f83fbe6413f37b0c7b368e14beb24604cadca4b2a4b"

      def install
        bin.install "stripe-mock"
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/stripe/stripe-mock/releases/download/v0.152.0/stripe-mock_0.152.0_darwin_amd64.tar.gz"
      sha256 "851c5f501278f287b59811b79944e116cea467a8ab8e41fc8f38d5f280a6bb77"

      def install
        bin.install "stripe-mock"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      url "https://github.com/stripe/stripe-mock/releases/download/v0.152.0/stripe-mock_0.152.0_linux_amd64.tar.gz"
      sha256 "486a5f3e2c0d9f4c0a967d21c62d6aa77071691b8c45d36fb1479470fd6023df"

      def install
        bin.install "stripe-mock"
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/stripe/stripe-mock/releases/download/v0.152.0/stripe-mock_0.152.0_linux_arm64.tar.gz"
      sha256 "68ed381911c36f8e433d149d8959e0b57ebf35daea2df96347e0c4a8e97fd216"

      def install
        bin.install "stripe-mock"
      end
    end
  end

  plist_options :startup => false

  service do
    keep_alive successful_exit: false

    run [
      opt_bin/"stripe-mock",
      "-http-port", 
      "12111",
      "-https-port",
      "12112"
    ]
    working_dir var
    environment_variables PATH: HOMEBREW_PREFIX/"bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    process_type :interactive
    log_path var/"log/stripe-mock.log"
    error_log_path var/"log/stripe-mock.log"
  end
end
